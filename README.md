# การตรวจจับวัตถุในเกม Ragnarok ด้วย YOLOv7

## ภาพรวม

โปรเจกต์นี้เป็นต้นแบบที่พัฒนาขึ้นโดยได้แรงบันดาลใจและความรู้จากแหล่งข้อมูลดังต่อไปนี้:
- [Udemy: PyTorch for Deep Learning](https://www.udemy.com/course/pytorch-for-deep-learning)
- [YouTube: KongRuksiamOfficial](https://www.youtube.com/@KongRuksiamOfficial)
- [Facebook: Learn To Developer](https://www.facebook.com/learntodeveloper)

ชมวิดีโอสาธิตการทำงานได้ที่: [Video Showcase](https://drive.google.com/file/d/13POpHSujrL1a_N3QFVyuV7xvRUZ4rlkI/view?usp=sharing)

โปรเจกต์นี้เป็นต้นแบบที่พัฒนาขึ้นโดยได้แรงบันดาลใจและความรู้จากแหล่งข้อมูลดังต่อไปนี้:

- [Udemy: PyTorch for Deep Learning](https://www.udemy.com/course/pytorch-for-deep-learning)
- [YouTube: KongRuksiamOfficial](https://www.youtube.com/@KongRuksiamOfficial)
- [Facebook: Learn To Developer](https://www.facebook.com/learntodeveloper)

- โปรเจกต์นี้เป็นระบบตรวจจับวัตถุสำหรับเกม "Ragnarok" โดยใช้โมเดล YOLOv7 โปรแกรมสามารถตรวจจับวัตถุในเกม เช่น ผู้เล่นและมอนสเตอร์ และโต้ตอบกับวัตถุเหล่านั้นตามกฎที่กำหนดไว้ ปัจจุบันฟีเจอร์สำหรับโต้ตอบ (เช่น การคลิกอัตโนมัติ) ถูกปิดใช้งานเนื่องจากข้อจำกัดในเกม แต่ระบบตรวจจับวัตถุทำงานได้อย่างสมบูรณ์

## คุณสมบัติเด่น

- **การตรวจจับวัตถุแบบเรียลไทม์** ด้วยโมเดล YOLOv7
- ระบุวัตถุในเกม เช่น "ผู้เล่น" และ "มอนสเตอร์"
- แสดงกรอบล้อมรอบวัตถุที่ตรวจจับได้พร้อมชื่อคลาสและระดับความมั่นใจ
- แสดงเวลาที่ผ่านไปนับตั้งแต่ตรวจจับคลาสล่าสุด
- จำลองการกดคีย์บอร์ดสำหรับการกระทำบางอย่างในเกม

## ความต้องการระบบ

- Python 3.7+
- ไลบรารีที่จำเป็น:
  - OpenCV
  - PyTorch
  - NumPy
  - Windowscapture (โมดูลที่กำหนดเอง)
  - ไลบรารีอื่นๆ ที่จำเป็น (ดูใน `requirements.txt`)

## การตั้งค่า

1. คัดลอกโปรเจกต์นี้:

   ```bash
   git clone https://github.com/yourusername/yolov7-ragnarok.git
   cd yolov7-ragnarok
   ```

2. ติดตั้งไลบรารีที่จำเป็น:

   ```bash
   pip install -r requirements.txt
   ```

3. นำโมเดล YOLOv7 ที่คุณมีไปวางในโฟลเดอร์ `model/` และตั้งชื่อว่า `ragnarok_tiny.pt` (หรือปรับเปลี่ยนโค้ดให้เหมาะสม)

4. อัปเดตชื่อหน้าต่างเกมในโค้ดหากจำเป็น:

   ```python
   window_name = "Ragnarok"
   ```

## การใช้งาน

### การรันโปรแกรมผ่าน Command Prompt
1. เปิด Command Prompt.
2. ใช้คำสั่ง `cd` เพื่อเข้าไปยังโฟลเดอร์ที่มีไฟล์ `main.py`.
   ```bash
   cd path/to/project-folder
   ```
3. รันสคริปต์หลักด้วยคำสั่ง:
   ```bash
   python main.py
   ```

- โปรแกรมจะจับภาพหน้าต่างเกมและตรวจจับวัตถุแบบเรียลไทม์
- วัตถุที่ตรวจจับได้จะแสดงด้วยกรอบล้อมรอบบนหน้าจอ
- กด `q` เพื่อออกจากโปรแกรม

รันสคริปต์หลัก:

```bash
python main.py
```

- โปรแกรมจะจับภาพหน้าต่างเกมและตรวจจับวัตถุแบบเรียลไทม์
- วัตถุที่ตรวจจับได้จะแสดงด้วยกรอบล้อมรอบบนหน้าจอ
- กด `q` เพื่อออกจากโปรแกรม

## หมายเหตุ

- **การโต้ตอบถูกปิดใช้งาน:** ฟีเจอร์การคลิก (`win32_clickRo`) ถูกคอมเมนต์ไว้เนื่องจากข้อจำกัดในเกม หากต้องการเปิดใช้งานให้ยกเลิกการคอมเมนต์ในบรรทัดที่เกี่ยวข้อง และตรวจสอบให้แน่ใจว่าระบบของคุณอนุญาตการกระทำอัตโนมัติ
  ```python
  # win32_clickRo(nearest_x, nearest_y)
  ```
- สามารถปรับค่าพารามิเตอร์การตรวจจับ เช่น ค่า confidence ได้หากจำเป็น:
  ```python
  model.conf = 0.25
  model.iou = 0.10
  ```

## การแก้ปัญหา

- หากรันคำสั่ง `python main.py` ไม่ได้ ให้ใช้คำสั่งต่อไปนี้ก่อน:
  ```bash
  set KMP_DUPLICATE_LIB_OK=TRUE
  ```
- ตรวจสอบให้แน่ใจว่าหน้าต่างเกมมองเห็นได้และตั้งชื่อถูกต้อง
- หากใช้ GPU ตรวจสอบว่าได้ติดตั้งและตั้งค่า CUDA เรียบร้อยแล้ว
- สำหรับการดีบัก ให้ยกเลิกการคอมเมนต์ print statements หรือเพิ่ม log เพิ่มเติมตามต้องการ

- ตรวจสอบให้แน่ใจว่าหน้าต่างเกมมองเห็นได้และตั้งชื่อถูกต้อง
- หากใช้ GPU ตรวจสอบว่าได้ติดตั้งและตั้งค่า CUDA เรียบร้อยแล้ว
- สำหรับการดีบัก ให้ยกเลิกการคอมเมนต์ print statements หรือเพิ่ม log เพิ่มเติมตามต้องการ

## ใบอนุญาต

โปรเจกต์นี้อยู่ภายใต้ลิขสิทธิ์ MIT License ดูรายละเอียดในไฟล์ `LICENSE`

